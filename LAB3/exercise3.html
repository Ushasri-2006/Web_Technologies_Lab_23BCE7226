<!DOCTYPE html>
<html>
<head>
  <title>Dynamic Survey Builder</title>
  <style>
    .error {
      color: red;
      font-size: 14px;
    }
    .question {
      margin-bottom: 15px;
    }
  </style>
</head>
<body>

<h2>Dynamic Survey</h2>

<form id="surveyForm"></form>
<button onclick="validateForm()">Submit</button>

<script>
const questions = [
  {
    id: 1,
    question: "What is your name?",
    type: "text",
    required: true,
    maxLength: 20
  },
  {
    id: 2,
    question: "Gender",
    type: "radio",
    required: true,
    options: ["Male", "Female", "Other"]
  },
  {
    id: 3,
    question: "Select your skills",
    type: "checkbox",
    required: true,
    options: ["HTML", "CSS", "JavaScript"],
    minSelect: 1,
    maxSelect: 2
  }
];

const form = document.getElementById("surveyForm");

/* 1️⃣ Dynamic Form Generation */
questions.forEach(q => {
  const div = document.createElement("div");
  div.className = "question";
  div.id = `q-${q.id}`;

  const label = document.createElement("label");
  label.innerText = q.question;
  div.appendChild(label);
  div.appendChild(document.createElement("br"));

  if (q.type === "text") {
    const input = document.createElement("input");
    input.type = "text";
    input.id = `input-${q.id}`;
    div.appendChild(input);
  }

  if (q.type === "radio" || q.type === "checkbox") {
    q.options.forEach(opt => {
      const input = document.createElement("input");
      input.type = q.type;
      input.name = `input-${q.id}`;
      input.value = opt;

      div.appendChild(input);
      div.appendChild(document.createTextNode(opt));
      div.appendChild(document.createElement("br"));
    });
  }

  const error = document.createElement("div");
  error.className = "error";
  error.id = `error-${q.id}`;
  div.appendChild(error);

  form.appendChild(div);
});

/* 2️⃣ Validation Function */
function validateForm() {
  let isValid = true;

  questions.forEach(q => {
    const errorDiv = document.getElementById(`error-${q.id}`);
    errorDiv.innerText = "";

    if (q.type === "text") {
      const value = document.getElementById(`input-${q.id}`).value.trim();

      if (q.required && value === "") {
        errorDiv.innerText = "This field is required.";
        isValid = false;
      } 
      else if (value.length > q.maxLength) {
        errorDiv.innerText = `Maximum ${q.maxLength} characters allowed.`;
        isValid = false;
      }
    }

    if (q.type === "radio") {
      const selected = document.querySelector(`input[name="input-${q.id}"]:checked`);
      if (q.required && !selected) {
        errorDiv.innerText = "Please select an option.";
        isValid = false;
      }
    }

    if (q.type === "checkbox") {
      const selected = document.querySelectorAll(`input[name="input-${q.id}"]:checked`);

      if (q.required && selected.length < q.minSelect) {
        errorDiv.innerText = `Select at least ${q.minSelect} option(s).`;
        isValid = false;
      } 
      else if (selected.length > q.maxSelect) {
        errorDiv.innerText = `Select no more than ${q.maxSelect} options.`;
        isValid = false;
      }
    }
  });

  if (isValid) {
    alert("Survey submitted successfully!");
  }
}
</script>

</body>
</html>
